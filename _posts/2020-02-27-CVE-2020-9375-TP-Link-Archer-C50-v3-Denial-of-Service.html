---
title: CVE-2020-9375 TP-Link Archer C50 v3 Denial of Service
desc: The Web Interface in Archer C50 V3 is vulnerable to a Denial of Service when anyone in network sends a specially crafted HTTP Header containing an unexpected Referer field.
layout: post
date: 2020-02-27 9:18
image: /images/posts/cve_2020_9375.png
---

<h1 class="cyan-text">CVE-2020-9375 TP-Link Archer C50 v3 Denial of Service</h1>
<div class="content white-text">
	<p>
		TP-Link Archer C50 is a popular router on <span class="cyan-text">Amazon.in</span> with <span class="cyan-text">over 7K</span> reviews and ratings and it is marked as <span class="cyan-text">Amazon's Choice</span>!
		<br><br>
		<span class="cyan-text">Vulnerability :</span> The Web Interface in Archer C50 V3 is vulnerable to a Denial of Service when anyone in network sends a specially crafted HTTP Header containing an unexpected Referer field.
		<br>
		<span class="cyan-text">Type of Vulnerability :</span> Denial of Service
		<br>
		<span class="cyan-text">Device :</span> TP-Link Archer C50 V3
		<br>
		<span class="cyan-text">CVE :</span> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9375">CVE-2020-9375</a>
		<br>
		<span class="cyan-text">CVE Status :</span> Assigned
		<br>
		<span class="cyan-text">Discovered By :</span> Lohitya Pushkar
		<br>
		<span class="cyan-text">Vulnerable Version :</span> Build 171227 and below
		<br>
		<span class="cyan-text">Patch :</span> Available! <a href="https://www.tp-link.com/in/support/download/archer-c50/v3/#Firmware">Build 200218</a>
	</p>
</div>
<h2 class="cyan-text">Attacking Setup</h2>
<div class="content white-text">
	<p>
		<span class="cyan-text">Connected with the router through WiFi/LAN</span>
		<br>
		<span class="cyan-text">Operating System :</span> Arch Linux 5.4.13-arch1-1 x86_64
	</p>
</div>
<h2 class="cyan-text">Exploit</h2>
<div class="content white-text">
	<p>
		Let’s verify if we can access the gateway and port 80 is open
	</p>
	<div class="center-img">
		<img class="responsive-img" src="https://imgur.com/KtDFDPY.png" alt="{{ page.title }}">
	</div>
	<p>
		As we can see port 80 is open and we can access router login page.
		Now we will create a new text file, I used headers.txt as file name for this step, in this file we will input the headers we want to send with the request we will be making later on
	</p>
	<div class="center-img">
		<img class="responsive-img" src="https://imgur.com/7l1nkUs.png" alt="{{ page.title }}">
	</div>
	<p>
		I am using Host, User-Agent and Referer in headers, Host and User-Agent are in standard format and are correct but take a look at Referer, the correct format of Referer field is as shown below :
		<br>
		<pre><code>Referer: https://developer.mozilla.org/en-US/docs/Web/JavaScript</code></pre>
		This is the point where the vulnerability is triggered, if we send Referer in incorrect format, the service on port 80 crashes and the port closes.
		<br>
		Now let’s try to trigger this vulnerability using curl, we will issue a simple GET request with the command below, to provide headers we will use -H argument of curl and specify our file which contains header i.e. headers.txt
	</p>
	<div class="center-img">
		<img class="responsive-img" src="https://imgur.com/NQf1cgH.png" alt="{{ page.title }}">
	</div>
	<p>
		In a normal scenario we get a status code along with the output of GET request but here we get Empty reply from server, which means the service crashed before it could reply and the connection was closed, now let’s check nmap again to see if port 80 is still open
	</p>
	<div class="center-img">
		<img class="responsive-img" src="https://imgur.com/MxL7zNA.png" alt="{{ page.title }}">
	</div>
	<p>
		And the port is closed, our exploit was successful and it resulted in a Denial of Service as the web interface cannot be accessed now until we reboot the router manually.
		<br>
		Similarly we can make a custom script and automate the whole process making it easy and fast, an example is shown below
	</p>
	<div class="center-img">
		<img class="responsive-img" src="https://imgur.com/65tEkiY.png" alt="{{ page.title }}">
	</div>

	<h2 class="cyan-text">Disclosure Timeline</h2>
	<table>
		<tr>
			<td>25-01-2020</td>
			<td>I sent information about the vulnerability to TP-Link</td>
		</tr>
		<tr>
			<td>26-01-2020</td>
			<td>TP-Link asked for a write-up and PoC</td>
		</tr>
		<tr>
			<td>26-01-2020</td>
			<td>I sent both write-up and PoC</td>
		</tr>
		<tr>
			<td>04-02-2020</td>
			<td>TP-Link says there is some permission issue with files and a disclosure period of 120 days is decided</td>
		</tr>
		<tr>
			<td>04-02-2020</td>
			<td>I sent both files again and acknowledge a 120 day disclosure period</td>
		</tr>
		<tr>
			<td>15-02-2020</td>
			<td>TP-Link acknowledges about getting both files</td>
		</tr>
		<tr>
			<td>17-02-2020</td>
			<td>TP-Link says the firmware in writeup is old a newer version is available and asks to test on that</td>
		</tr>
		<tr>
			<td>17-02-2020</td>
			<td>I acknowledged and tested and the latest build was also vulnerable</td>
		</tr>
		<tr>
			<td>19-02-2020</td>
			<td>TP-Link sends a patch for testing</td>
		</tr>
		<tr>
			<td>19-02-2020</td>
			<td>I tested and patch worked, I notified TP-Link and asked about when an update will be available</td>
		</tr>
		<tr>
			<td>20-02-2020</td>
			<td>TP-Link says it's an old version and they are not sure about an update</td>
		</tr>
		<tr>
			<td>21-02-2020</td>
			<td>TP-Link agrees for an update</td>
		</tr>
		<tr>
			<td>26-02-2020</td>
			<td>TP-Link says firmware will be available soon</td>
		</tr>
		<tr>
			<td>27-02-2020</td>
			<td>TP-Link says firmware is now available on their official download page</td>
		</tr>
	</table>
</div>
